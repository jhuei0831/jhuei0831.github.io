---
title: Web Vulnerability Prevent
layout: post
featured-img: 20220430
categories:
- CODE
tags:
- php
- javascript
- Vulnerability Assessment
- Penetration Test
- Source Code Analysis
- 弱點掃描
- 滲透測試
- 源碼掃描
description: 弱點掃描、滲透測試或源碼檢測網路漏洞風險修補方法分享
---

### 前言
---
分享一些PHP或JS弱點掃描、滲透測試或源碼檢測遇到的風險處理方法。

### 目錄
---
1. [Cross Site Scripting](#xss)
2. [SQL Injection](#sql_injection)
3. [Path Manipulation](#path_manipulation)
4. [Cross-Site Scripting: DOM](#xss_dom)
5. [Password Management: Hardcoded Password](#password_management_hardcoded_password)
6. [Insecure Randomness](#insecure_randomness)


{: id='xss'}
### XSS
---

1. 8.1版前可以使用 [`filter_var($variable, FILTER_SANITIZE_STRING)`](https://www.php.net/manual/en/function.filter-var) ，但是`FILTER_SANITIZE_STRING`在PHP8.1版被棄用了。
2. 使用[`htmlspecialchars($variable, ENT_QUOTES)`](https://www.php.net/manual/en/function.htmlspecialchars)(使用ENT_QUOTES為雙引號與單引號都要轉換)。

<div class="notice--info">
filter_var是直接把html的tag給去除掉，htmlspecialchars是把特殊字元轉換成編碼。
</div>


{: id='sql_injection'}
### SQL Injection
---

1. 治本方法就是使用PDO。
2. 使用[`addslashes()`](https://www.php.net/manual/en/function.addslashes)可以解決大部分問題。

{: id='path_manipulation'}

### Path Manipulation
---
使用[`realpath()`](https://www.php.net/manual/en/function.realpath)過濾掉`../`，使用[`basename()`](https://www.php.net/manual/en/function.basename)取得檔案名稱。


{: id='xss_dom'}
### Cross-Site Scripting: DOM
---

使用js將資料傳給物件時，不要使用`innerHTML`，使用`innerText`。

{: id='password_management_hardcoded_password'}
### Password Management: Hardcoded Password
---

不要將密碼直接打在程式碼上，可以使用[`dotenv`](https://github.com/vlucas/phpdotenv)


{: id='insecure_randomness'}
### Insecure Randomness
---

使用[`random_int()`](https://www.php.net/manual/en/function.random-int.php)，這個函數產生。
